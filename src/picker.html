<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API</title>
    <link rel="stylesheet" href="static/swiper.min.css">
    <link rel="stylesheet" href="static/zui.css">
    <link rel="stylesheet" href="css/api.css">

    <style>
        * {
            user-select: none;
        }

        #date-picker {
            margin: 90px 0;
            background: #f5f5f5;
            border-top: 1px solid #dcdcdc !important;
            border-bottom: 1px solid #dcdcdc !important;
        }

        #position-picker {
            margin: 50px 0;
            background: #f5f5f5;
            border-top: 1px solid #dcdcdc !important;
            border-bottom: 1px solid #dcdcdc !important;
        }

        #shouru-picker {
            margin: 50px 0;
            background: #f5f5f5;
            border-top: 1px solid #dcdcdc !important;
            border-bottom: 1px solid #dcdcdc !important;
        }

        .picker-select-index {
            border-top: 1px solid #dcdcdc;
            border-bottom: 1px solid #dcdcdc;
            box-shadow: none !important;
            background: rgba(0, 0, 0, 0.3);
            /*box-shadow: 0 0 1px #00abeb;*/
            /*position: absolute;
            width: 100%;*/
        }

        li {
            list-style: none;
            font-size: 18px;
            color: #999;
            font-family: Arial;
            font-weight: 500;
            background-color: transparent;
        }

        .__picker {

        }

        .__index {
            color: #333;
            /*transform: scale3d(1, 1, 1) !important;*/
        }

        .__prev {

        }

        .__next {

        }

        .flex {
            display: flex;
        }

        .flex1 {
            flex: 1;
        }

        .flex4 {
            flex: 8;
        }
    </style>
</head>
<body>

<section id="date-picker" class="flex"></section>
<section id="position-picker" class="flex"></section>
<section id="shouru-picker" class="flex"></section>

</body>
<script type="text/javascript">


    var picker = function (id, options) {

        if (!id) {
            alert("容器 id 不能为空");
            return
        }

        options = options || {};//为空则初始化
        this._parentId = id;
        this._modelData = options.viewData || viewData;//视图层数据
        this._lineHeight = options.lineHeight || 34;//px *此处lineHeight需要在样式中设置！
        this._moveDistance = options.moveDistance || 4;//每次滚动的单位 px ，加快滚动速度，与回弹速度
        this._moveRatio = options.moveRatio || 4;// 移动系数 数字越小 拖动后滚动的距离越远
        this._dragSpeed = options.dragSpeed || 1; //拖动速度加倍
        this._speed = options.speed || 500;// 1~1000 自动滚动速度 越大越快
        this._character = options.character || null;
        this._showLines = options.showLines || 5;

        this.init = function () {//全局初始化

            //禁止容器内的mousemove(PC)和touchmove(Mobile)事件

            this.resetPICKER(this._parentId);//清空容器事件;

            //存放所有picker的id的数组
            this._pickerIdList = [];

            //初始化Picker(最外层容器)总高度
            this._$(id).style.height = this._lineHeight * this._showLines + "px";
            this._$(id).style.overflow = "hidden";
            this._$(id).style.userSelect = "none";
            this._$(id).style.position = "relative";
            this._$(id).style.cursor = "default";
            this._$(id).style.transform = "rotateY(0)";
            this._$(id).style.borderTop = "1px solid #ececec";
            this._$(id).style.borderBottom = "1px solid #ececec";

            this._pickerNum = Object.keys(this._modelData.data).length;

            //渲染DOM
            this.renderHtml(id, this._modelData);

            //初始化每个picker的最大可移动距离
            var dataListJson = this._modelData.data;
            this.initPickerMoveDistance(id, dataListJson);


            //初始化绑定事件
            this.initBindEvent();

        }
        this.init();
    }
    picker.prototype.resetPICKER = function (id) {
        this._$(id).onclick = null;
        this._$(id).onmousemove = null;
        this._$(id).addEventListener("touchstart", function (e) {
            e.stopPropagation();
            e.preventDefault();
            return false
        })
        this._$(id).addEventListener("touchmove", function (e) {
            e.stopPropagation();
            e.preventDefault();
            return false
        })
        this._$(id).addEventListener("touchend", function (e) {
            e.stopPropagation();
            e.preventDefault();
            return false
        })
    }
    picker.prototype._$ = function (id) {
        return document.getElementById(id);
    }
    /*初始化每个picker的最大移动距离*/
    picker.prototype.initPickerMoveDistance = function (id, dataListJson) {
        for (var data in dataListJson) {

            var pk_cid = data;
            var _height = "_Max-" + id + "-" + pk_cid + "-Move-Distance";
            var _index = "_Max-" + id + "-" + pk_cid + "-Index";
            var _moving = "_Max-" + id + "-" + pk_cid + "-Moving";
            var _forceStop = "_ForceStop-" + id + "-" + pk_cid;


            //存放所有picker的强制停止状态,默认都是关闭的
            this[_forceStop] = false;

            //存放所有picker的Id的数组
            this._pickerIdList.push(id + "-" + pk_cid);

            //初始化每个picker的滚动状态
            this[_moving] = false;//刚开始都是停止状态

            //初始化每个picker的最大可滚动到的index
            this[_index] = dataListJson[data].list.length - 1;

            //初始化每个picker的最大高度
            this[_height] = this[_index] * this._lineHeight;
            //console.log("INITHEIGHT:::" + _height + ":" + this[_height])

            //初始化每个picker的当前选中元素
            var indexId = id + "-" + dataListJson[data].cid + "-0";
            this.initSelect(indexId);

            //初始化当前选中项的列表
            //this._selectOptions = this.getSelectOptionsList();
        }
    }
    /*初始化选中的元素的类名,id选中元素的id*/
    picker.prototype.initSelect = function (id, index) {
        index = index || 0;
        this._$(id) && this._$(id).setAttribute("class", "__index")
        this._$(id) && this._$(id).parentNode.setAttribute("selectIndex", index)

        this._$(id)
    }
    /*使用HTML填充显示PCIKER的容器*/
    picker.prototype.renderHtml = function (id, viewData) {
        var html = this.renderTpl(id, viewData);
        this._$(id).innerHTML = html;
    }
    /*根据模版渲染HTML*/
    picker.prototype.renderTpl = function (id, viewData) {

        var data = viewData.data;
        var chr = this._character;
        var str = "";
        var _x = 0;

        for (var key in data) {

            var dt = data[key];

            //每个picker的容器
            str += "<div  class='flex4' style='margin-top:" + this._lineHeight * (parseInt(this._showLines / 2) - 1) + "px'>";
            str += "<ul id='" + id + "-" + dt.cid + "' class='__picker' style='transform:translateY(0);transform-style: preserve-3d;'>";
            str += "<li class='__prev' style='white-space:nowrap;text-align:center;" +
                "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px '></li>";

            //渲染每个picker的单个元素
            for (var i = 0; i < dt.list.length; i++) {
                var _dt = dt.list[i];
                str += "<li   id='" + id + "-" + dt.cid + "-" + i + "' style='white-space:nowrap;text-align:center;" + "" +//transform: scale3d(0.95,0.95,0.95);
                    "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px '>" + _dt + dt.suffix + "</li>";
            }

            str += "<li class='__next' style='white-space:nowrap;text-align:center;" +
                "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px '></li>";
            str += "</ul>";
            str += "</div>";


            //在每个picker之间添加间隔符号
            _x++;
            if (_x != this._pickerNum && this._character) {
                str += "<div  class='flex1' style='margin-top:" + this._lineHeight * (parseInt(this._showLines / 2) - 1) + "px'>";
                str += "<ul>"
                str += "<li class='__prev' style='white-space:nowrap;text-align:center;" +
                    "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px'></li>";
                str += "<li class='__index' style='white-space:nowrap;text-align:center;" +
                    "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px'>" + chr + "</li>";
                str += "<li class='__next' style='white-space:nowrap;text-align:center;" +
                    "height:" + this._lineHeight + "px;line-height:" + this._lineHeight + "px'></li>";
                str += "</ul>"
                str += "</div>";
            }

        }
        str += "<div  class='picker-select-index'"
            + "style='box-shadow: 0 0 1px #00abeb;left:0;width:100%;"
            + "position:absolute;pointer-events:none;z-index:1;"
            + "background-color:transparent;transform:translateY(0);zoom:1;height:"
            + this._lineHeight + "px;margin-top:"
            + this._lineHeight * (parseInt(this._showLines / 2)) + "px'></div>";

        return str;
    }
    /*滚动的动画效果*/
    picker.prototype.slideY = function (id, distance, direction, translateY) {

        //滚动效果-匀速滚动
        this.slideUniform(id, distance, direction, translateY);

    }
    /*缓慢减速滚动*/
    picker.prototype.slideSlowness = function (id, distance, direction, st) {

        clearInterval(st);

        var t = 0;
        var _st = setInterval(function () {
            t += 0.1;
            var translateY = (this._$(id).style.transform.split("translateY(")[1]).split("px)")[0];
            var position = Number(translateY) + Number(direction + t);

            this._$(id).style.transform = "translateY(" + position + "px )";


        }, 1000 / this._speed)


    }
    /*匀速滚动*/
    picker.prototype.slideUniform = function (id, distance, direction, translateY) {
        var i = 0;
        var scope = this;
        var st = setInterval(function () {

            //强制停止开关,为true，则强制停止
            if (scope["_ForceStop-" + id]) {
                scope.forceStopCallBack(id, st);
            }


            var position = Number(translateY) + Number(direction + i);

            /*if (i > distance) {//当滚动接近边界或者接近对应选项时

             scope.slideSlowness(id, distance, direction, st);
             return;

             }*/

            if (distance == i) {

                scope._$(id).style.transform = "translateY(" + position + "px )";
                var index = Math.abs(position / scope._lineHeight);//
                scope.selectIndex(id, index);

                scope["_Max-" + id + "-Moving"] = false;

                //console.log(scope)
                //更新当前选中项的列表
                scope.callbackOps(id, st);

            } else if (i > distance) {//当滚动的基本单位(_moveDistance)变化时，由于当前坐标+n*_moveDistance不可能=distance
                //i -= scope._moveDistance;
                //滚动越界或者未精确定位到对应选项时，自动回退
                //i -= scope._moveDistance;
                i -= 0.5;
                position = Number(translateY) + Number(direction + i);
                scope._$(id).style.transform = "translateY(" + position + "px )";

                scope["_Max-" + id + "-Moving"] = true;
                //scope.slideSlowness(id, distance, direction, translateY);
            } else {

                i += scope._moveDistance;

                /*if ((i + scope._moveDistance) > distance) {//当滚动的基本单位(_moveDistance)变化时，由于当前坐标+n*_moveDistance不可能=distance
                 i -= scope._moveDistance;
                 //滚动越界或者未精确定位到对应选项时，自动回退
                 i += 0.5;
                 position = Number(translateY) + Number(direction + i);
                 scope._$(id).style.transform = "translateY(" + position + "px )";

                 scope["_Max-" + id + "-Moving"] = true;
                 //scope.slideSlowness(id, distance, direction, translateY);
                 return;
                 }*/
                scope._$(id).style.transform = "translateY(" + position + "px )";
                scope["_Max-" + id + "-Moving"] = true;

            }

        }, 1000 / this._speed)//控制滚动速度

    }
    /*强制停止滚动回调*/
    picker.prototype.forceStopCallBack = function (id, st) {
        clearInterval(st);

        this["_ForceStop-" + id] = false;//关闭强制停止事件
    }
    /*滚动停止时自动回调*/
    picker.prototype.callbackOps = function (id, st) {

        //this._selectOptions = this.getSelectOptionsList();
        clearInterval(st);

        this["_ForceStop-" + id] = false;//关闭强制停止事件

        //!this["LDown-" + id] &&  //拖动状态下禁止自动贴合
        this.autoFit(id);//自动贴合最近的index

        //console.log(this._selectOptions);
        return this;
    }
    /*选中当前滚动到中间的元素,id为当前picker的ul的id*/
    picker.prototype.selectIndex = function (id, index) {
        this.removeSelect(id);
        var sId = id + "-" + index;
        this.initSelect(sId, index);
    }
    /*移除当前picker的选中元素*/
    picker.prototype.removeSelect = function (id) {
        var index = this._$(id).getAttribute("selectIndex");
        this._$(id + "-" + index) && this._$(id + "-" + index).setAttribute("class", "")

    }
    /*滚动到上一个*/
    picker.prototype.scrollPrev = function (id) {
        var selectIndex = this._$(id).getAttribute("selectIndex");
        var index = parseInt(selectIndex) - 1;//向上为负
        var check = this.checkIndex(id, index);
        check && this.scrollToIndex(id, index);
        return this;
    }
    /*滚动到下一个*/
    picker.prototype.scrollNext = function (id) {
        var selectIndex = this._$(id).getAttribute("selectIndex");
        var index = parseInt(selectIndex) + 1;//向下为正
        var check = this.checkIndex(id, index);
        check && this.scrollToIndex(id, index);
        return this;
    }
    /*滚动到第index个元素，index从0开始，*/
    picker.prototype.scrollToIndex = function (id, index) {

        var check = this.checkIndex(id, index);
        if (!check)return false;
        //console.log(id + ":scrollTo " + index);

        var startPosition = (this._$(id).style.transform.split("translateY(")[1]).split("px)")[0];
        var endPosition = -this._lineHeight * index;//停止位置
        //console.log("ID " + id + " Start " + startPosition + " StartIndex " + Math.abs(parseInt(startPosition / this._lineHeight)) + " End " + endPosition + " EndIndex " + index);
        this.scrollY(id, endPosition, startPosition);

        return this;

    }
    /*y轴方向的移动,startY 起始位置 endY 停止位置*/
    picker.prototype.scrollY = function (id, endY, startY) {


        //startY <=0
        var distance = Math.abs(startY) - Math.abs(endY);
        var direction = distance >= 0 ? "+" : "-";//向上滚动为负

        //兼容从零开始向下滚动越界
        if (startY > 0) direction = "-";

        //限制移动距离
        distance = Math.abs(distance);
        //if(distance)

        this.slideY(id, distance, direction, startY);

    }
    /*校验越界，id为当前picker的id，index为将要滚动到的index*/
    picker.prototype.checkIndex = function (id, index) {

        //界限参数获取
        var minIndex = 0,
            selectIndex = this._$(id).getAttribute("selectIndex"),
            maxIndex = this["_Max-" + id + "-Index"];


        //处理越界
        if (index == selectIndex) {//当前位置，校准位置

            var translateY = (this._$(id).style.transform.split("translateY(")[1]).split("px)")[0];
            var shouldBeY = -this._lineHeight * index;
            //console.log(id + "translateY " + translateY + " shouldBeY " + shouldBeY);

            if (translateY == shouldBeY) {
                //console.log(id + " 当前位置精准无需移动!  startID " + selectIndex + " toIndex " + index);
                return false;
            }


        } else if (index < minIndex) {//超出滚动范围
            //console.warn(id + "滚动范围越界!");
            index = 0
        } else if (index > maxIndex) {
            index = maxIndex;
        }
        return true;
    }
    /*滚动到第一个元素*/
    picker.prototype.scrollFirst = function (id) {
        this.scrollToIndex(id, 0);
        return this;
    }
    /*滚动到最后一个元素,id为单个picker的id*/
    picker.prototype.scrollLast = function (id) {
        var maxIndex = this["_Max-" + id + "-Index"];
        this.scrollToIndex(id, maxIndex);
        return this;
    }
    /*自动贴近最近的一个index元素*/
    picker.prototype.autoFit = function (id) {

        var fitIndex = this.getFitIndex(id);
        var ratio = this["Ratio-" + id];
        this.resetMoveRatio(id);
        /*if (ratio > 0) {*/
        fitIndex = Math.abs(parseInt(fitIndex * (1 + ratio)));
        /*} else {
         fitIndex = Math.abs(parseInt(fitIndex * (ratio)));
         }*/

        this.scrollToIndex(id, fitIndex)
    }
    /*获取当前距离最近的Index*/
    picker.prototype.getFitIndex = function (id) {

        var translateY = this._$(id).style.transform.split("translateY(")[1].split("px)")[0];
        var maxIndex = this["_Max-" + id + "-Index"]
        var fitIndex;

        //添加移动系数
        translateY = parseInt(translateY);
        //this.resetMoveRatio(id);
        //console.log("translateY---translateY---ratio" + ratio);
        if (translateY < 0 && Math.abs(translateY) <= this._lineHeight * maxIndex) {

            //console.log(id + " AutoFit-1 " + translateY)

            fitIndex = parseInt(Math.abs(translateY) / this._lineHeight) + parseInt((Math.abs(translateY) % this._lineHeight) * 2 / this._lineHeight);

            if (fitIndex > maxIndex) {
                fitIndex = maxIndex;
            } else {
                console.log(id + " AutoFit-1-0 " + fitIndex)
            }

        } else if (translateY > 0) {
            fitIndex = 0;
            console.log(id + " AutoFit-2 " + fitIndex)
        } else if (Math.abs(translateY) > this._lineHeight * maxIndex) {
            fitIndex = maxIndex;
            console.log(id + " AutoFit-3 " + fitIndex)
        } else {
            fitIndex = 0;
            console.log(id + " AutoFit-4 " + fitIndex)
        }
        return parseInt(fitIndex);
    }
    /*顶部反弹（自动贴合）*/
    picker.prototype.autoFitFirst = function (id) {
        this.scrollFirst(id);
    }
    /*底部反弹（自动贴合）*/
    picker.prototype.autoFitLast = function (id) {
        this.scrollLast(id);
    }
    /*强制停止滚动*/
    picker.prototype.forceStop = function (id) {
        this["_ForceStop-" + id] = true;
        //this.autoFit(id);
    }
    /*停止所有picker的滚动*/
    picker.prototype.stopAll = function () {
        var pickerList = this._pickerIdList;
        for (var i = 0; i < pickerList.length; i++) {
            this.forceStop(pickerList[i]);
        }
    }
    /*当前选中项的值*/
    picker.prototype.getSelectOptionsList = function (type) {
        var selectIdList = this.getSelectIdList();

        var options = [];
        for (var i = 0; i < selectIdList.length; i++) {
            var txt = this._$(selectIdList[i]).innerText;
            options.push(txt)
        }
        if (type == "str") {
            return options.join(this._character)
        } else {
            return options
        }
    }
    /*当前选中的index*/
    picker.prototype.getSelectIndexList = function () {
        var idList = this._pickerIdList;
        var indexList = [];
        for (var i = 0; i < idList.length; i++) {
            var sIndex = this._$(idList[i]).getAttribute("selectIndex");
            indexList.push(sIndex);
        }
        return indexList;
    }
    /*当前选中项的id*/
    picker.prototype.getSelectIdList = function () {
        var idList = this._pickerIdList;
        var indexList = this.getSelectIndexList();
        var selectIdList = [];
        for (var i = 0; i < idList.length; i++) {
            var sId = idList[i] + "-" + indexList[i];
            selectIdList.push(sId);
        }
        return selectIdList;
    }
    /*初始化所有pciker的绑定事件*/
    picker.prototype.initBindEvent = function () {
        var idList = this._pickerIdList;
        for (var i = 0; i < idList.length; i++) {
            this.bindEvent(idList[i]);
        }
    }
    /*绑定事件 mousemove, mouseout mousedown leftclick*/
    picker.prototype.bindEvent = function (id) {

        var touch = ('ontouchstart' in window) ||
            window.DocumentTouch && document instanceof DocumentTouch;

        /*PC端拖动*/
        if (!touch) {
            //绑定鼠标左键点击事件到触发leftMouseDown
            this.bindMouseDown(id, this.leftMouseDown);

            //绑定鼠标左键点击事件mouseup 或者 mouseout
            this.BindMouseEnd(id);

            //console.log("PC---------------------------")
        } else {

            /*mobile端拖动*/
            this.BindTouchEvent(id);
            //console.log("Mobile---------------------------")
        }


    }


    /*手机端touchmove touchstart touchend*/
    picker.prototype.BindTouchEvent = function (id) {
        var scope = this;
        this._$(id).addEventListener("touchstart", function (e) {

            var pBefore = scope.getMouseBefore(id, e);
            scope["startY-" + id] = pBefore.y;
            scope["first-startY-" + id] = pBefore.y;
            //scope["last-endY-" + id] = pBefore.y;
            scope["_Max-" + id + "-Moving"] && scope.forceStop(id);
            scope["startTime-" + id] = new Date().getTime();

            //console.log(id + " touchstart " + pBefore.y);
            //console.log(id + " touchend " + scope["last-endY-" + id]);
            e.stopPropagation();
            return false;
        }, false)

        this._$(id).addEventListener("touchmove", function (e) {


            var pAfter = scope.getMouseAfter(id, e);
            scope["endY-" + id] = pAfter.y;

            var info = scope.getMoveInfo(id);//获取移动的详细信息
            scope.followScroll(id, info);//跟随鼠标


            //console.log(id + " touchmove"+pAfter.y);
            e.stopPropagation();
            e.preventDefault();
            return false;
        }, false)

        this._$(id).addEventListener("touchend", function (e) {

            var pAfter = scope.getMouseAfter(id, e);
            scope["endTime-" + id] = new Date().getTime();

            scope["last-endY-" + id] = pAfter.y;//用户只是点击未拖动时，

            //console.log(id + " first-startY " + scope["first-startY-" + id]);
            //console.log(id + " last-endY " + scope["last-endY-" + id]);

            //console.log(e);
            scope.getMoveRatio(id);
            scope.autoFit(id);//滚动自动校准

            e.stopPropagation();
            e.preventDefault();
            return false;
        }, false)

    }
    /*阻止手机端全局拖动事件*/
    /* picker.prototype.removeTouch = function (id) {

     }
     */
    /*鼠标left up或者 mouseout*/
    picker.prototype.BindMouseEnd = function (id) {
        var scope = this;
        this._$(id).onmouseup = function (e) {
            if (scope["LDown-" + id])
                scope.leftMouseUp(e, id, scope);
        }
        /*this._$(this._parentId).onmouseleave = function (e) {
         if (scope["LDown-" + id] == true)
         scope.leftMouseUp(e, id, scope);
         }*/
        this._$(id).onmouseleave = function (e) {
            if (scope["LDown-" + id])
                scope.leftMouseUp(e, id, scope);
        }
    }
    /*绑定鼠标移动事件*/
    picker.prototype.bindMouseMove = function (id) {
        var scope = this;
        this._$(id).onmousemove = function (e) {
            if (scope["LDown-" + id]) {
                var pAfter = scope.getMouseAfter(id, e);
                scope["endY-" + id] = pAfter.y;

                var info = scope.getMoveInfo(id);//获取移动的详细信息
                scope.followScroll(id, info);//跟随鼠标

            } else {

                scope.autoFit(id);
                scope.removeMouseMove(id);
            }
        }
    }
    /*获取移动系数*/
    picker.prototype.getMoveRatio = function (id) {
        var startTime = this["startTime-" + id];
        var endTime = this["endTime-" + id];
        var startY = this["first-startY-" + id];
        var endY = this["last-endY-" + id] || startY;

        //移动系数（单位时间内的移动距离）
        //console.log(" startTime " + startTime + " endTime " + endTime + " startY " + startY + " endY " + endY);
        var moveRatio = /*Math.abs*/((startY - endY) / (endTime - startTime) / this._moveRatio);

        //开启惯性拖动
        /*if(moveRatio>0.3){*/
        this["Ratio-" + id] = moveRatio;
        //this["Ratio-" + id] = 0;
        /*}else{
         this["Ratio-" + id] = 0;
         }*/

        console.log("移动系数：：：：：：" + moveRatio + " startTime " + startTime + " endTime " + endTime);


        //return moveRatio;
    }
    /*移动系数清空*/
    picker.prototype.resetMoveRatio = function (id) {
        //this["startTime-" + id] = 1;
        //this["endTime-" + id] = this["startTime-" + id]+1;
        this["Ratio-" + id] = 0;
        //console.log(this)
        //this["first-startY-" + id] = this["last-endY-" + id];
        //this["last-endY-" + id] = this["first-startY-" + id];
    }
    /*移除鼠标移动事件*/
    picker.prototype.removeMouseMove = function (id) {
        this._$(id).onmousemove = null;
    }
    /*跟随鼠标拖动*/
    picker.prototype.followScroll = function (id, p) {

        //console.log(p)
        //var direction = p.beforeY >= p.afterY ? "-" : "+"
        var distance = p.beforeY - p.afterY;

        var startPosition = (this._$(id).style.transform.split("translateY(")[1]).split("px)")[0];

        var touch = ('ontouchstart' in window) ||
            window.DocumentTouch && document instanceof DocumentTouch;
        var endPosition;
        if (!touch) {
            endPosition = startPosition - distance * this._dragSpeed;//停止位置
        } else {
            endPosition = startPosition - distance * this._dragSpeed;//停止位置
        }

        //console.log("endPosition" + endPosition)
        this._$(id).style.transform = "translateY(" + endPosition + "px )";
        this["startY-" + id] = p.afterY;
        //console.log("ID " + id + " Start " + startPosition + " StartIndex " + Math.abs(startPosition / this._lineHeight) + " End " + endPosition + " EndIndex " + index);
        //this.scrollY(id, endPosition, startPosition);

    }
    /*鼠标左键点击触发事件,注意scope*/
    picker.prototype.leftMouseDown = function (e, id, scope) {

        var pStart = scope.getMouseBefore(id, e);
        scope["LDown-" + id] = true;//鼠标左键点击状态，此状态下禁止autoFit的滚动
        scope["_Max-" + id + "-Moving"] && scope.forceStop(id);
        scope["startY-" + id] = pStart.y;
        scope["first-startY-" + id] = pStart.y;
        scope["startTime-" + id] = new Date().getTime();
        //绑定鼠标移动事件
        scope.bindMouseMove(id, this.getMouseMove);


        //console.log(id + " drag START " + pStart.x + " " + pStart.y)
    }
    /*鼠标左键弹起触发事件，注意scope*/
    picker.prototype.leftMouseUp = function (e, id, scope) {

        var pAfter = scope.getMouseAfter(id, e);
        scope["LDown-" + id] = false;//鼠标左键点击状态
        scope["endTime-" + id] = new Date().getTime();
        scope["last-endY-" + id] = pAfter.y;
        scope.getMoveRatio(id);
        scope.removeMouseMove(id);//移除绑定事件

        scope.autoFit(id);//自动贴合

        //console.log(id + " drag END " + p.x + " " + p.y)
    }
    /*绑定鼠标左键（右键，中间滑轮）点击事件*/
    picker.prototype.bindMouseDown = function (id, left, middle, right) {

        var scope = this;//此处

        var args = [].slice.call(arguments);

        args[0] = function () {
        };

        args[1] = args[1] || args[0];
        args[2] = args[2] || args[0];
        args[3] = args[3] || args[0];

        //绑定mousedown事件
        scope._$(id).onmousedown = function (e) {
            e = e || window.event;
            var button = e.button;
            if (!e.which && isFinite(button)) {
                e.which = [0, 1, 3, 0, 2, 0, 0, 0][button];//0现在代表没有意义
            }
            //备注：假如此处调用leftMouseDown 所以要传递scope过去，否则leftMouseDown中的this指向改变
            args[e.which](e, id, scope);
        }
    }
    /*获取鼠标或手指移动范围*/
    picker.prototype.getMoveInfo = function (id) {

        var move = {
            beforeY: this["startY-" + id],
            afterY: this["endY-" + id]
        };

        return move;
    }
    /*根据e获取鼠标当前坐标*/
    picker.prototype.getMousePosition = function (e) {
        var touch = ('ontouchstart' in window)
            || window.DocumentTouch && document instanceof DocumentTouch;

        var p = {};

        if (!touch) {
            var x = e.pageX
                || (e.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft));

            var y = e.pageY
                || (e.clientY + (document.documentElement.scrollTop || document.body.scrollTop));

            p = {'x': x, 'y': y};
        } else {
            var pos = e.changedTouches[0];     //touches数组对象获得屏幕上所有的touch，取第一个touch
            p = {"x": pos.pageX, "y": pos.pageY};    //取第一个touch的坐标值
        }

        //console.log(p)

        return p;

    }
    /*获取鼠标点击左键之后的坐标*/
    picker.prototype.getMouseBefore = function (id, e) {
        return this.getMousePosition(e);
    }
    /*获取鼠标点击右键或者移出picker范围边界之后的坐标*/
    picker.prototype.getMouseAfter = function (id, e) {
        return this.getMousePosition(e);
    }
    /*export default {
     name: 'picker',
     data () {
     return {}
     },
     mounted(){*/
    var viewData = {
        data: {
            year: {
                cid: "year",// 当前列ID
                suffix: "年",//当前列后缀
                list: ["2016", "2017", "2018", "2019", "2020", "2016", "2017", "2018", "2019", "2020", "2016", "2017", "2018", "2019", "2020", "2016", "2017", "2018", "2019", "2020", "2016", "2017", "2018", "2019", "2020"]
            },
            month: {
                cid: "month",
                suffix: "月",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]
            },
            day: {
                cid: "day",
                suffix: "日",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"]
            },
            hour: {
                cid: "hour",
                suffix: "时",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"]

            },
            minute: {
                cid: "minute",
                suffix: "分",
                list: ["1", "2", "3"]
            },
            second: {
                cid: "second",
                suffix: "秒",
                list: ["1", "2", "3"]
            },
            divided: {
                cid: "divided",
                suffix: "",
                list: ["上午", "下午"]
            }
        }
    }
    var positionData = {
        data: {
            sheng: {
                cid: "sheng",// 当前列ID
                suffix: "省",//当前列后缀
                list: ["河南", "河北", "江苏", "四川", "山东"]
            },
            shi: {
                cid: "shi",
                suffix: "市",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]
            },
            xian: {
                cid: "xian",
                suffix: "县",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"]
            },
        }
    }
    var shouruData = {
        data: {
            sheng: {
                cid: "sheng",// 当前列ID
                suffix: "省",//当前列后缀
                list: ["河南", "河北", "江苏", "四川", "山东"]
            },
            shi: {
                cid: "shi",
                suffix: "市",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]
            },
            xian: {
                cid: "xian",
                suffix: "县",
                list: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"]
            },
        }
    }
    //初始化date-picker
    var _pk = new picker("date-picker", {"viewData": viewData, "character": "-", "lineHeight": 48, "showLines": 3});//注意 只是启用链式调用语法，并非是等前面的执行完毕才执行
    var _ppk = new picker("position-picker", {
        "viewData": positionData,
        "character": "-",
        "lineHeight": 48,
        "showLines": 3
    });
    var _pppk = new picker("shouru-picker", {"viewData": shouruData, "lineHeight": 48, "showLines": 3});
    //_pk.scrollNext("date-picker-month");//滚动到下一月
    /* var i = 0;*/
    /*setInterval(function () {
     if(i>12){
     _pk.scrollToIndex("date-picker-month", 0);
     i=0;
     }else{
     i++;
     _pk.scrollToIndex("date-picker-month", i);

     }

     },1000)*/

    /*.scrollToIndex("date-picker-minute", 2)
     .scrollToIndex("date-picker-minute", 2)
     .scrollNext("date-picker-second")//滚动到上一个
     .scrollLast("date-picker-year")//滚动到底部
     .scrollLast("date-picker-hour")//滚动到底部
     //console.log(_pk._selectOptions)

     var st = setTimeout(function () {
     _pk.scrollLast("date-picker-day")
     .scrollNext("date-picker-divided")
     .scrollPrev("date-picker-minute")
     .scrollToIndex("date-picker-month", 1)
     .scrollFirst("date-picker-hour")//滚动到头部
     .scrollPrev("date-picker-second", 19)//滚动到头部
     //console.log(_pk._selectOptions)

     clearTimeout(st)
     }, 5000)

     var st1= setTimeout(function () {
     _pk.stopAll()
     },5800)*/
    /*    },
     components: {}
     }*/
</script>

</html>